<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>JADE Addin</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/acorn/8.11.3/acorn.min.js" integrity="sha512-qsbZzESFnMN1Zz5cujkpYFK7wysw2sDerv2/OUYiMMfEJY6h4h7o8vWytbAnPFUUpLhKfqmF+4BixPBBnbVUyg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!--script src="https://cdnjs.cloudflare.com/ajax/libs/acorn/8.6.0/acorn.min.js" integrity="sha512-GxXGTaS+f1zewxxP8YJT8y74B9jarcQzPSP3j1+pYKk4pMmOikcKBZmjVP+U1+wAiAqv+FwISQXZnPRmdWXaEw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script-->
    <script type="text/javascript" src="lib/odin/index.js"></script>
    <script type="text/javascript" src="index.js"></script>
    <script type="text/javascript" src="api.js"></script>

<script>
      function initialize(){
        // check for ID
          Office.onReady(function(a){
            if (navigator.userAgent.indexOf("Trident") === -1) {
              try{
                Jade.officeReady(a)
              }catch(e){
                document.getElementById("error-msg").style.display = "block"
              }
            }else{
              document.getElementById("ie-msg").style.display = "block"
            }
          });
      }
        

    </script>
    <style id="head_style" data-name="system">

body{
    margin: -5;
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    background-color: #EEE;/*rgb(252,239,205);*/
    font-size: 1.2rem;
    font-family: Roboto,Helvetica Neue,sans-serif;
}
.jade-head{
    display:block;
    background-color: rgb(4, 117, 55);
    padding: 3rem 1rem 1rem 1rem;
   
}
.jade-logo{
    display:inline-block;
    padding: 1rem;
    border-radius: 50%;
    background-color: white;
    margin: auto;
    display: table;
    
}

.jade-heading-1{
  font-weight: 100;
  color:white;
  font-size: 3rem;
  text-align:center;
  word-wrap: break-word;
  line-height: 100%;
}

.jade-heading-2{
    font-weight: 400;
    /*color:#800000;*/
    font-size: 2rem;
    text-align:center;
    word-wrap: break-word;
    line-height: 100%;
}

.jade-small-heading{
    font-weight: 400;
    /*color:#800000;*/
    font-size: 1rem;
    text-align:center;
    word-wrap: break-word;
    line-height: 100%;
  }


.jade-body{
      padding: 0 1.5rem 1.5rem 1.5rem;
  }
.jade-table{
        margin-left: auto;
        margin-right: auto;
        border-spacing: .5rem;
        font-weight: 500;
}
.jade-clickable{
  cursor:pointer

}  


.panel-selector{
                width:100%;
                margin:0;
                background-color: rgb(1, 93, 43);
                color:white;
                font-weight: 100;
                padding:0 0 0 1.5rem;
                font-size: 1.2rem;

            }

.panel-selector-option{
    background-color: white;
    color:black;
}
.ace_editor { 
            position:absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            
        }   

.content{
    padding: 0 .5rem 0 .5rem
}
.editor-content{
    padding: 0
}
.top-corner{
    position:absolute;
    top:0;
    right:0;
    color:grey;
}   
.hidden{
    display:none
}
/*
.fas, .far {
  color: #800000;
}*/
.jade-form{
    text-align: left;
    font-size: 1rem;
    width:15rem;

}
.jade-output{
    margin:.5rem;
 
}
.jade-output-header{
    background-color: rgb(6, 100, 48);
    color:white;
    padding:.2rem .2rem .2rem 1rem;
    font-weight: bold;
}

.jade-output-close{
    float:right;
    width:3rem;
    text-align: right;
}

.jade-output-body{
    background-color: white;
    color:black;
    padding: .5rem;
}

.jade-output-time{
    color: limegreen;
    margin-right: 1rem;
}

#jade-alert {
    position: fixed;
    top: 0;
    border:2px solid black ;
    z-index:99;
    min-width: 200px;
    max-width: 90%;
    left: 50%;
    transform: translate(-50%, 0);
}
.jade-alert-header{
    background-color: royalBlue;
    color:white;
    padding:.2rem .2rem .2rem 1rem;
    font-weight: bold;
}

.jade-alert-close{
    position:absolute;
    top:0;
    right:0;
    width:3rem;
    text-align: right;
}

.jade-alert-body{
    background-color: white;
    color:black;
    padding: .5rem;
}
.menu-link {
   color:inherit;
   text-decoration: none;
}
h2{
  margin-bottom: 0;
}
.link{
  cursor:pointer;
}
.jade-info{
cursor:default;
}

</style>

</head>
<body onload="initialize()">
  <div id="panel_home" style="display:none">  
    <div class="jade-head">
        <div class="jade-logo">
          <img width="90" height="90" src="https://byuis.github.io/taskpane/assets/logo-filled.png" alt="JADE" title="JADE" />
        </div>
        <h1 class="jade-heading-1">JADE</h1>
      </div> 
    <div class="jade-body"> 
    <section id="menu-msg"  style="display:none">
      
      <h2  class="jade-small-heading">JavaScript Automation Development Environment</h2>
      <table id="menu" class="jade-table"  style="margin-top: 1rem;">

        <tr class="jade-clickable" id="open-tools">
          <td><i class="fas fa-screwdriver-wrench"></i></td>
          <td>Excel Tools</td>
        </tr>

        <tr class="jade-clickable hidden" id="open-editor">
          <td><i class="fas fa-laptop-code"></i></td>
          <td>Open Code Editor</td>
        </tr>

        <tr id="add-module-row" class="jade-clickable" >
          <td><i class="far fa-window-maximize"></i></td>
          <td>Add a Code Module</td>
        </tr>
        <tr id="add-module" class="hidden">
          <td colspan=2><input id="new-module-name" style="width:11rem" placeholder="Module Name"/>
            <button id="module-add-button" >Add</button></td>
        </tr>

        <tr id="show-import-module-row" class="jade-clickable">
            <td><i class="fas fa-file-import"></i></td>
          <td>Import a Code Module</td>
        </tr>
        <tr id="import-module" class="hidden">
          <td colspan=2> <input id="gist-url" style="width:10.5rem"  placeholder="URL or Gist ID"/>
            <button id="module-import-button">Import</button></td>
        </tr>

        <tr id="open-examples-row" class="jade-clickable">
          <td><i class="fas fa-graduation-cap"></i></td>
          <td>Show Examples</td>
        </tr>

        <tr id="list-automations-row" class="jade-clickable">
          <td><i class="fas fa-list-ol"></i></td>
          <td>List Automations</td>
        </tr>

        <tr class="jade-clickable">
          <td><i class="fas fa-book"></i></td>
          <td><a class="menu-link" href="https://support.jsvba.com/2021/12/support.html" target="_blank">View Documentation</a></td>
        </tr>

        <tr id="show-survey-row" class="jade-clickable">
          <td><i class="far fa-comment-alt"></i></td>
          <td>Send Feedback</td>
        </tr>
        <tr id="survey" class="hidden">
          <td colspan=2 style="text-align:center"> 
              <select id="fb-type" style="width:15.4rem">
                  <option value="" disabled selected hidden>Type of feedback...</option>
                  <option value="Feature Resuest">Request a feature</option>
                  <option value="Report Issue">Report a problem</option>
                  <option value="Praise for Addin">Praise for this add-in</option>
                  <option value="Offer to help with development">Offer to help with development</option>
                  <option value="Question">Ask a question</option>
                </select><br />
                <select id="fb-platform" style="width:15.4rem">
                    <option value="" disabled selected hidden>MS Office Platform...</option>
                    <option value="All">All</option>
                    <option value="Mac">Mac</option>
                    <option value="Windows">Windows</option>
                    <option value="Online">Online</option>
                    <option value="iPad">iPad</option>
                    <option value="Android">Android</option>
                    <option value="Other">Other</option>
                </select><br />
                <input id="fb-email" style="width:15rem" placeholder="Your email address (optional)"/><br />
                <textarea id="fb-text" style="height:5rem;width:15rem;margin-top: 5px;" placeholder="The text of your feedback..."></textarea><br />
                <button id="fb-button">Submit</button>
                <div id="fb-message" style="width:15rem;color:red;text-align:left"></div>
          </td>
        </tr>

        <tr id="show-settings-row" class="jade-clickable">
            <td><i class="fas fa-cog"></i></td>
            <td>Settings</td>
          </tr>
          <tr id="settings-page" class="hidden">
            <td colspan=2 style="text-align:center" class="jade-form"> 
                <div class="jade-form"><a class="jade-info" title="The ID of a github gist with examples">Examples Gist ID</a></div>
                <input id="examples-gist-id" style="width:15.4rem">

                <div class="jade-form" style="margin-top: .3rem;"><a class="jade-info" title="Load the code from this github gist when add-in loads.">Load Code Gist ID or URL</a></div>
                <input id="load-gist-id" style="width:15.4rem">

                <div class="jade-form" style="margin-top: .3rem;">Editor Theme</div>
                <select id="jade-theme" style="width:15.4rem">
                    <option value="ambiance">Ambiance</option>
                    <option value="chaos">Chaos</option>
                    <option value="chrome">Chrome</option>
                    <option value="clouds">Clouds</option>
                    <option value="clouds_midnight">Clouds Midnight</option>
                    <option value="cobalt">Cobalt</option>
                    <option value="crimson_editor">Crimson Editor</option>
                    <option value="dawn">Dawn</option>
                    <option value="dracula">Dracula</option>
                    <option value="dreamweaver">Dreamweaver</option>
                    <option value="eclipse">Eclipse</option>
                    <option value="github">Github</option>
                    <option value="gob">Gob</option>
                    <option value="gruvbox">Gruvbox</option>
                    <option value="idle_fingers">Idle Fingers</option>
                    <option value="iplastic">Iplastic</option>
                    <option value="katzenmilch">Katzenmilch</option>
                    <option value="kr_theme">Kr Theme</option>
                    <option value="kuroir">Kuroir</option>
                    <option value="merbivore">Merbivore</option>
                    <option value="merbivore_soft">Merbivore Soft</option>
                    <option value="mono_industrial">Mono Industrial</option>
                    <option value="monokai">Monokai</option>
                    <option value="nord_dark">Nord Dark</option>
                    <option value="one_dark">One Dark</option>
                    <option value="pastel_on_dark">Pastel On Dark</option>
                    <option value="solarized_dark">Solarized Dark</option>
                    <option value="solarized_light" selected>Solarized Light</option>
                    <option value="sqlserver">Sqlserver</option>
                    <option value="terminal">Terminal</option>
                    <option value="textmate">Textmate</option>
                    <option value="tomorrow">Tomorrow</option>
                    <option value="tomorrow_night">Tomorrow Night</option>
                    <option value="tomorrow_night_blue">Tomorrow Night Blue</option>
                    <option value="tomorrow_night_bright">Tomorrow Night Bright</option>
                    <option value="tomorrow_night_eighties">Tomorrow Night Eighties</option>
                    <option value="twilight">Twilight</option>
                    <option value="vibrant_ink">Vibrant Ink</option>
                    <option value="xcode">Xcode</option>
                </select><br />
                <div class="jade-form" style="margin-top: .3rem;">Editor Word Wrap</div>
                <select id="jade-word-wrap" style="width:15.4rem">
                    <option value="no-wrap" selected>Do not wrap long lines</option>
                    <option value="wrap">Wrap long lines</option>
                    <option value="wrap-indented">Wrap and indent long lines</option>
                </select><br />
                <div class="jade-form"  style="margin-top: .3rem;">Editor Font Size</div>
                <select id="jade-font-size" style="width:15.4rem">
                    <option value="6">6pt</option>
                    <option value="8">8pt</option>
                    <option value="10">10pt</option>
                    <option value="12">12pt</option>
                    <option value="14" selected>14pt</option>
                    <option value="18">18pt</option>
                    <option value="20">20pt</option>
                    <option value="24">24pt</option>
                    <option value="36">36pt</option>
                    <option value="48">48pt</option>
                </select><br />
                <div class="jade-form"  style="margin-top: .3rem;">Show Line Numbers <input id="jade-line-numbers" type="checkbox" value="true"/></div>
                <br />
                  <button id="settings-button">Save</button>
            </td>
          </tr>
  
        

    </table>
  </section>
  <section id="sideload-msg"  style="display:none">
    <h2 class="jade-heading-2">This add-in must be run from inside Excel.</h2>
  </section>

  <section id="error-msg"  style="display:none">
    <h2 class="jade-heading-2">There was an error loading this add-in.</h2>
  </section>

  <section id="ie-msg"  style="display:none; text-align:center">
    <h2  class="jade-heading-2">JavaScript Automation Development Environment</h2><br>
    This add-in won't run in your version of Office. Please upgrade to either one-time purchase Office 2021 or to a Microsoft 365 account.
  </section>
  </div>
</div>
</body>

</html>
